---

# Search for a rrule value for an existing Schedule on the API https://tower-dev.schroders.com/api/v2/schedules/
# for available parameter see https://docs.ansible.com/ansible/latest/collections/awx/awx/schedule_module.html#ansible-collections-awx-awx-schedule-module

ansible_tower_config:
  default:
    schedules:
  prd:
    schedules:
      ETI_eti_data_pipelines-lm_sql_capacity-daily:
        unified_job_template: ETI_eti_data_pipelines-lm_sql_capacity
        rrule:  DTSTART;TZID=Europe/London:20201013T033000 RRULE:FREQ=DAILY;INTERVAL=1
      ETI_eti_data_pipelines-statseeker-splunk-sli-daily: 
        unified_job_template: ETI_eti_data_pipelines-statseeker-splunk-sli
        rrule: DTSTART;TZID=Europe/London:20210512T041000 RRULE:FREQ=DAILY;INTERVAL=1
      ETI_eti_data_pipelines-lm_splunk_blackouts-daily: 
        unified_job_template: ETI_eti_data_pipelines-lm_splunk_blackouts
        rrule: DTSTART;TZID=Europe/London:20201014T003000 RRULE:FREQ=DAILY;INTERVAL=1
      ETI_eti_data_pipelines-cmdb-lm-lifecycle-hourly:  
        rrule: "{{ query('ansible.tower.tower_schedule_rrule', 'hour', start_date='2021-01-01 16:20:00', timezone='Europe/London',  every='1') }}"
        unified_job_template: ETI_eti_data_pipelines-cmdb-lm-lifecycle-update      
      ETI_eti_data_pipelines-lm_splunk_lookup_daily: 
        unified_job_template: ETI_eti_data_pipelines-lm_splunk_lookups
        rrule: DTSTART;TZID=Europe/London:20201127T001500 RRULE:FREQ=DAILY;INTERVAL=1
      ETI_eti_data_pipelines-lm_splunk_sli-daily: 
        unified_job_template: ETI_eti_data_pipelines-lm_splunk_sli
        rrule: DTSTART;TZID=Europe/London:20201014T001500 RRULE:FREQ=DAILY;INTERVAL=1
      ETI_eti_data_pipelines-isilon-splunk-av-5m:
        unified_job_template: ETI_eti_data_pipelines-isilon-splunk-av
        rrule: "{{ query('ansible.tower.tower_schedule_rrule', 'minute', start_date='2021-01-01 00:00:00', timezone='Europe/London',  every='5') }}"
        enabled: True
  dev:
    schedules:
      ETI_eti_data_pipelines-isilon-splunk-av-5m:
        unified_job_template: ETI_eti_data_pipelines-isilon-splunk-av
        rrule: "{{ query('ansible.tower.tower_schedule_rrule', 'minute', start_date='2021-01-01 00:00:00', timezone='Europe/London',  every='5') }}"
        enabled: False
      ETI_eti_data_pipelines-lm_sql_capacity-daily:
        unified_job_template: ETI_eti_data_pipelines-lm_sql_capacity
        rrule:  DTSTART;TZID=Europe/London:20201014T033000 RRULE:FREQ=DAILY;INTERVAL=1
      ETI_eti_data_pipelines-lm_splunk_blackouts-daily:
        rrule: DTSTART;TZID=Europe/London:20201013T033000 RRULE:FREQ=DAILY;INTERVAL=1
        unified_job_template: ETI_eti_data_pipelines-lm_splunk_blackouts
      ETI_eti_data_pipelines-cmdb-lm-lifecycle-8h:  
        rrule: "{{ query('ansible.tower.tower_schedule_rrule', 'hour', start_date='2021-01-01 17:30:00', timezone='Europe/London',  every='8') }}"
        unified_job_template: ETI_eti_data_pipelines-cmdb-lm-lifecycle-add-delete
      ETI_eti_data_pipelines-cmdb-lm-lifecycle-1h:  
        rrule: "{{ query('ansible.tower.tower_schedule_rrule', 'hour', start_date='2021-07-29 16:50:00', timezone='Europe/London',  every='1') }}"
        unified_job_template: ETI_eti_data_pipelines-cmdb-lm-lifecycle-update-dev
      UNIX_inventory_refresh_hourly:  
        rrule: DTSTART;TZID=Europe/London:20201204T100000 RRULE:FREQ=MINUTELY;INTERVAL=30
        unified_job_template: UNIX_inventory_refresh
    
     
