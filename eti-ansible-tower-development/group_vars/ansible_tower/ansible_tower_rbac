# Additionally as part of the RBAC role the following RBAC settings are applied
#
# ADMIN users are given the following roles to their main team's organization
# [project_admin, inventory_admin, credential_admin, workflow_admin, notification_admin, job_template_admin]
#
# USER users are given the following roles to their main team's organization 
# [execute]

ansible_tower_config:
  default:
    roles:
      UNIX_ADMIN_SCHRODERS_INTERNAL_execute: &UNIX_ADMIN_SCHRODERS_INTERNAL_execute
        team: UNIX_ADMIN
        organization: SCHRODERS_INTERNAL
        role: execute
      WINTEL_ADMIN_SCHRODERS_INTERNAL_execute: &WINTEL_ADMIN_SCHRODERS_INTERNAL_execute
        team: WINTEL_ADMIN
        organization: SCHRODERS_INTERNAL
        role: execute
  prd:
    roles:
      UNIX_USER_SCHRODERS_INTERNAL_execute:
        <<: *UNIX_ADMIN_SCHRODERS_INTERNAL_execute
      WINTEL_ADMIN_SCHRODERS_INTERNAL_execute:
        <<: *WINTEL_ADMIN_SCHRODERS_INTERNAL_execute
  dev:
    roles:
      UNIX_ADMIN_SCHRODERS_INTERNAL_execute:
        <<: *UNIX_ADMIN_SCHRODERS_INTERNAL_execute
      WINTEL_ADMIN_SCHRODERS_INTERNAL_execute:
        <<: *WINTEL_ADMIN_SCHRODERS_INTERNAL_execute
  c_b:
    roles:
      UNIX_ADMIN_SCHRODERS_INTERNAL_execute:
        <<: *UNIX_ADMIN_SCHRODERS_INTERNAL_execute
      WINTEL_ADMIN_SCHRODERS_INTERNAL_execute:
        <<: *WINTEL_ADMIN_SCHRODERS_INTERNAL_execute

ansible_settings_rbac:
  AUTH_LDAP_BIND_DN: "CN=z_awxbind_{{ TIER }},OU=Service Accounts,OU=London,OU=UK,DC=schroders,DC=com"
  AUTH_LDAP_BIND_PASSWORD: "{{ z_awxbind_dev if TIER != 'prd' else z_awxbind_prd}}" 
  AUTH_LDAP_SERVER_URI: "ldap://lon0001.schroders.com,ldap://lon0004.schroders.com"
  AUTH_LDAP_GROUP_TYPE: "ActiveDirectoryGroupType"
  AUTH_LDAP_REQUIRE_GROUP: CN=GBL ROL IT Ansible Tower AWX Base User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
  AUTH_LDAP_USER_SEARCH: 
      - 'DC=schroders,DC=com'
      - 'SCOPE_SUBTREE'
      - '(sAMAccountName=%(user)s)'
  AUTH_LDAP_GROUP_SEARCH: 
      - "DC=schroders,DC=com"
      - "SCOPE_SUBTREE"
      - "(objectClass=group)"
  AUTH_LDAP_USER_ATTR_MAP: 
      first_name: givenName
      last_name: sn
      email: userPrincipalName
  AUTH_LDAP_GROUP_TYPE_PARAMS: 
      name_attr: cn
  AUTH_LDAP_USER_FLAGS_BY_GROUP: 
      is_superuser: 
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Super User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
  AUTH_LDAP_ORGANIZATION_MAP: 
      SCHRODERS_INTERNAL:
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Super User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
      SCHRODERS:
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Super User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: CN=GBL ROL IT Ansible Tower AWX Base User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      UNIX: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} Unix Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Unix User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Unix Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com 
        remove_users: True 
      DBA: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} DBA admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} DBA User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} DBA admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      WINTEL: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} DBA admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Wintel User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Wintel admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      EUC: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} EUC admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} EUC User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} EUC admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      DEVOPS: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} DevOPS admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} DevOPS User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} DevOPS admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      INFOSEC: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} IS admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} IS User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} IS Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      TEMS: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} TEMS admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} TEMS User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} TEMS admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      ADP: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} ADP Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} ADP User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} ADP Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      NETWORKS: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} Networks admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Networks User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Networks admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      SERVICEDESK: 
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Service Desk User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Service Desk Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      RTC: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} RTC admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} RTC User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} RTC admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      PRODSUPPORT: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} Production Support admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Production Support User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Production Support admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      STORAGE: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} Storage admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Storage User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Storage admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      CPSRE: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} CPSRE admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} CPSRE User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} CPSRE admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_users: True 
      ETI: 
        admins: CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Disabled') }} Super User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        remove_admins: True
        users: 
          - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} ETi User,OU=Global Groups,DC=schroders,DC=com
        remove_users: True 
  AUTH_LDAP_TEAM_MAP: 
      SCHRODERS:
        organization: SCHRODERS
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX Base User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Super User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      ETI_USER:
        organization: ETI
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} ETI User,OU=Global Groups,DC=schroders,DC=com
      UNIX_USER:
        organization: UNIX
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Unix User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      UNIX_ADMIN:
        organization: UNIX
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Unix Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      DBA_USER:
        organization: DBA
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} DBA User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      DBA_ADMIN:
        organization: DBA
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} DBA admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      WINTEL_USER:
        organization: WINTEL
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Wintel User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      WINTEL_ADMIN:
        organization: WINTEL
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Wintel Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      DEVOPS_USER:
        organization: DEVOPS
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} DevOPS User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      DEVOPS_ADMIN:
        organization: DEVOPS
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} DevOPS Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      INFOSEC_USER:
        organization: INFOSEC
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} IS User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      INFOSEC_ADMIN:
        organization: INFOSEC
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} IS Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      TEMS_USER:
        organization: TEMS
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} TEMS User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      TEMS_ADMIN:
        organization: TEMS
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} TEMS Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      ADP_USER:
        organization: ADP
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} ADP User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      ADP_ADMIN:
        organization: ADP
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} ADP Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      NETWORKS_USER:
        organization: NETWORKS
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Networks User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      NETWORKS_ADMIN:
        organization: NETWORKS
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Networks Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      SERVICEDESK_USER:
        organization: SERVICEDESK
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Service Desk User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      SERVICEDESK_ADMIN:
        organization: SERVICEDESK
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Service Desk Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      RTC_USER:
        organization: RTC
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} RCT User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      RTC_ADMIN:
        organization: RTC
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} RCT Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      EUC_USER:
        organization: EUC
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} EUC User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      EUC_ADMIN:
        organization: EUC
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} EUC admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      PRODSUPPORT_USER:
        organization: PRODSUPPORT
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Production Support User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      PRODSUPPORT_ADMIN:
        organization: PRODSUPPORT
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Production Support Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      STORAGE_USER:
        organization: STORAGE
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Storage User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      STORAGE_ADMIN:
        organization: STORAGE
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} Storage Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      CPSRE_USER:
        organization: CPSRE
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} CPSRE User,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
      CPSRE_ADMIN:
        organization: CPSRE
        remove: True
        users:
        - CN=GBL ROL IT Ansible Tower AWX {{ TIER|replace('dev','Dev')|replace('prd','Prod') }} CPSRE Admin,OU=Groups,OU=London,OU=UK,DC=schroders,DC=com
