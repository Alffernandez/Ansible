# https://docs.ansible.com/ansible/latest/collections/awx/awx/credential_module.html#ansible-collections-awx-awx-credential-module
ansible_tower_config:
  default:
    custom_credential_types: &custom_credential_types
      servicenow_dev:
        description: ServiceNow credentials to use within the dynamic inventory
        input:
          fields:
            - id: INVENTORY_CMDB_TIER
              type: string
              label: INVENTORY_CMDB_TIER
              help_text: >-
                Can be either "dev", "test" or "prod", it will set the ServiceNow 
                instance      
            - id: INVENTORY_REFRESH
              type: string
              label: INVENTORY_REFRESH
              help_text: >-
                If set to "True" Redis will be ignored and data will always be retrieved
                from ServiceNow
            - id: SNOW_LOGIN
              type: string
              label: SNOW_LOGIN
            - id: SNOW_PASSWORD
              type: string
              label: SNOW_PASSWORD
              secret: true
          required:
            - SNOW_LOGIN
            - SNOW_PASSWORD       
        injector:
          env:
            INVENTORY_CMDB_TIER: !unsafe '{{ INVENTORY_CMDB_TIER }}'
            INVENTORY_REFRESH:   !unsafe '{{ INVENTORY_REFRESH }}'
            SNOW_LOGIN:          !unsafe '{{ SNOW_LOGIN }}'
            SNOW_PASSWORD:       !unsafe '{{ SNOW_PASSWORD }}'

      servicenow:
        input:
          fields:
            - id: SNOW_LOGIN
              type: string
              label: SNOW_LOGIN
            - id: SNOW_PASSWORD
              type: string
              label: SNOW_PASSWORD
              secret: true
            - id: PROXY_LOGIN
              type: string
              label: PROXY_LOGIN
            - id: PROXY_PASSWORD
              type: string
              label: PROXY_PASSWORD
              secret: true
          required:
            - SNOW_LOGIN
            - SNOW_PASSWORD
            - PROXY_LOGIN
            - PROXY_PASSWORD
        injector:
          env:
            SNOW_LOGIN:     !unsafe "{{ SNOW_LOGIN }}"
            SNOW_PASSWORD:  !unsafe "{{ SNOW_PASSWORD }}"
            PROXY_LOGIN:    !unsafe "{{ PROXY_LOGIN }}"
            PROXY_PASSWORD: !unsafe "{{ PROXY_PASSWORD }}"
      storage_db_regen:
        input:
          fields:
            - id: GIT_TOKEN
              type: string
              label: GIT_TOKEN
              secret: true
            - id: PURE_PRIVATE_SSH_KEY
              type: string
              multiline: True 
              label: PURE_PRIVATE_SSH_KEY
              secret: true
          required:
            - GIT_TOKEN
            - PURE_PRIVATE_SSH_KEY
        injector:
          extra_vars:
            GIT_TOKEN:    !unsafe "{{ GIT_TOKEN }}"
            PURE_PRIVATE_SSH_KEY: !unsafe "{{ PURE_PRIVATE_SSH_KEY }}"
      docker_registry:
        input:
          fields:
            - id: DOCKER_LOGIN
              type: string
              label: DOCKER_LOGIN
            - id: DOCKER_PASSWORD
              type: string
              label: DOCKER_PASSWORD
              secret: true
          required:
            - DOCKER_LOGIN
            - DOCKER_PASSWORD
        injector:
          extra_vars:
            DOCKER_LOGIN:    !unsafe "{{ DOCKER_LOGIN }}"
            DOCKER_PASSWORD: !unsafe "{{ DOCKER_PASSWORD }}"
      schroders_compute_terraform:
        input:
          fields:
            - id: TF_VAR_SNW_DEV_USERNAME
              type: string
              label: TF_VAR_SNW_DEV_USERNAME
            - id: TF_VAR_SNW_DEV_PASSWORD
              type: string
              label: TF_VAR_SNW_DEV_PASSWORD
              secret: true
            - id: TF_VAR_SNW_PRD_USERNAME
              type: string
              label: TF_VAR_SNW_PRD_USERNAME
            - id: TF_VAR_SNW_PRD_PASSWORD
              type: string
              label: TF_VAR_SNW_PRD_PASSWORD
              secret: true
            - id: TF_VAR_WIN_DHCP_DEV_USERNAME
              type: string
              label: TF_VAR_WIN_DHCP_DEV_USERNAME
            - id: TF_VAR_WIN_DHCP_DEV_PASSWORD
              type: string
              label: TF_VAR_WIN_DHCP_DEV_PASSWORD
              secret: true
            - id: TF_VAR_WIN_DHCP_PRD_USERNAME
              type: string
              label: TF_VAR_WIN_DHCP_PRD_USERNAME
            - id: TF_VAR_WIN_DHCP_PRD_PASSWORD
              type: string
              label: TF_VAR_WIN_DHCP_PRD_PASSWORD
              secret: true
            - id: TF_VAR_LM_DEV_API_ID
              type: string
              label: TF_VAR_LM_DEV_API_ID
            - id: TF_VAR_LM_DEV_API_KEY
              type: string
              label: TF_VAR_LM_DEV_API_KEY
              secret: true
            - id: TF_VAR_LM_PRD_API_ID
              type: string
              label: TF_VAR_LM_PRD_API_ID
            - id: TF_VAR_LM_PRD_API_KEY
              type: string
              label: TF_VAR_LM_PRD_API_KEY
              secret: true
            - id: TF_VAR_VSP_SDX_USERNAME
              type: string
              label: TF_VAR_VSP_SDX_USERNAME
            - id: TF_VAR_VSP_SDX_PASSWORD
              type: string
              label: TF_VAR_VSP_SDX_PASSWORD
              secret: true
            - id: TF_VAR_VSP_DEV_USERNAME
              type: string
              label: TF_VAR_VSP_DEV_USERNAME
            - id: TF_VAR_VSP_DEV_PASSWORD
              type: string
              label: TF_VAR_VSP_DEV_PASSWORD
              secret: true
            - id: TF_VAR_VSP_UAT_USERNAME
              type: string
              label: TF_VAR_VSP_UAT_USERNAME
            - id: TF_VAR_VSP_UAT_PASSWORD
              type: string
              label: TF_VAR_VSP_UAT_PASSWORD
              secret: true
            - id: TF_VAR_VSP_PRD_USERNAME
              type: string
              label: TF_VAR_VSP_PRD_USERNAME
            - id: TF_VAR_VSP_PRD_PASSWORD
              type: string
              label: TF_VAR_VSP_PRD_PASSWORD
              secret: true
            - id: TF_VAR_AD_DEV_PROXY_VM_USERNAME
              type: string
              label: TF_VAR_AD_DEV_PROXY_VM_USERNAME
            - id: TF_VAR_AD_DEV_PROXY_VM_PASSWORD
              type: string
              label: TF_VAR_AD_DEV_PROXY_VM_PASSWORD
              secret: true
            - id: TF_VAR_AD_PRD_PROXY_VM_USERNAME
              type: string
              label: TF_VAR_AD_PRD_PROXY_VM_USERNAME
            - id: TF_VAR_AD_PRD_PROXY_VM_PASSWORD
              type: string
              label: TF_VAR_AD_PRD_PROXY_VM_PASSWORD
              secret: true
            - id: TF_VAR_VSP_GBL_VM_WINDOWS_DEFAULT_ADMIN_PASSWORD
              type: string
              label: TF_VAR_VSP_GBL_VM_WINDOWS_DEFAULT_ADMIN_PASSWORD
              secret: true
            - id: TF_VAR_VSP_VM_DOMAIN_JOIN_USERNAME
              type: string
              label: TF_VAR_VSP_VM_DOMAIN_JOIN_USERNAME
            - id: TF_VAR_VSP_VM_DOMAIN_JOIN_PASSWORD
              type: string
              label: TF_VAR_VSP_VM_DOMAIN_JOIN_PASSWORD
              secret: true

          required:
            - TF_VAR_SNW_DEV_USERNAME
            - TF_VAR_SNW_DEV_PASSWORD
            - TF_VAR_SNW_PRD_USERNAME
            - TF_VAR_SNW_PRD_PASSWORD
            - TF_VAR_WIN_DHCP_DEV_USERNAME
            - TF_VAR_WIN_DHCP_DEV_PASSWORD
            - TF_VAR_WIN_DHCP_PRD_USERNAME
            - TF_VAR_WIN_DHCP_PRD_PASSWORD
            - TF_VAR_LM_DEV_API_ID
            - TF_VAR_LM_DEV_API_KEY
            - TF_VAR_LM_PRD_API_ID
            - TF_VAR_LM_PRD_API_KEY
            - TF_VAR_VSP_SDX_USERNAME
            - TF_VAR_VSP_SDX_PASSWORD
            - TF_VAR_VSP_DEV_USERNAME
            - TF_VAR_VSP_DEV_PASSWORD
            - TF_VAR_VSP_UAT_USERNAME
            - TF_VAR_VSP_UAT_PASSWORD
            - TF_VAR_VSP_PRD_USERNAME
            - TF_VAR_VSP_PRD_PASSWORD
            - TF_VAR_AD_DEV_PROXY_VM_USERNAME
            - TF_VAR_AD_DEV_PROXY_VM_PASSWORD
            - TF_VAR_AD_PRD_PROXY_VM_USERNAME
            - TF_VAR_AD_PRD_PROXY_VM_PASSWORD
            - TF_VAR_VSP_GBL_VM_WINDOWS_DEFAULT_ADMIN_PASSWORD
            - TF_VAR_VSP_VM_DOMAIN_JOIN_USERNAME
            - TF_VAR_VSP_VM_DOMAIN_JOIN_PASSWORD

        injector: 
          extra_vars:
            TF_VAR_SNW_DEV_USERNAME:                          !unsafe "{{TF_VAR_SNW_DEV_USERNAME }}"
            TF_VAR_SNW_DEV_PASSWORD:                          !unsafe "{{TF_VAR_SNW_DEV_PASSWORD }}"
            TF_VAR_SNW_PRD_USERNAME:                          !unsafe "{{TF_VAR_SNW_PRD_USERNAME }}"
            TF_VAR_SNW_PRD_PASSWORD:                          !unsafe "{{TF_VAR_SNW_PRD_PASSWORD }}"
            TF_VAR_WIN_DHCP_DEV_USERNAME:                     !unsafe "{{TF_VAR_WIN_DHCP_DEV_USERNAME }}"
            TF_VAR_WIN_DHCP_DEV_PASSWORD:                     !unsafe "{{TF_VAR_WIN_DHCP_DEV_PASSWORD }}"
            TF_VAR_WIN_DHCP_PRD_USERNAME:                     !unsafe "{{TF_VAR_WIN_DHCP_PRD_USERNAME }}"
            TF_VAR_WIN_DHCP_PRD_PASSWORD:                     !unsafe "{{TF_VAR_WIN_DHCP_PRD_PASSWORD }}"
            TF_VAR_LM_DEV_API_ID:                             !unsafe "{{TF_VAR_LM_DEV_API_ID }}"
            TF_VAR_LM_DEV_API_KEY:                            !unsafe "{{TF_VAR_LM_DEV_API_KEY }}"
            TF_VAR_LM_PRD_API_ID:                             !unsafe "{{TF_VAR_LM_PRD_API_ID }}"
            TF_VAR_LM_PRD_API_KEY:                            !unsafe "{{TF_VAR_LM_PRD_API_KEY }}"
            TF_VAR_VSP_SDX_USERNAME:                          !unsafe "{{TF_VAR_VSP_SDX_USERNAME }}"
            TF_VAR_VSP_SDX_PASSWORD:                          !unsafe "{{TF_VAR_VSP_SDX_PASSWORD }}"
            TF_VAR_VSP_DEV_USERNAME:                          !unsafe "{{TF_VAR_VSP_DEV_USERNAME }}"
            TF_VAR_VSP_DEV_PASSWORD:                          !unsafe "{{TF_VAR_VSP_DEV_PASSWORD }}"
            TF_VAR_VSP_UAT_USERNAME:                          !unsafe "{{TF_VAR_VSP_UAT_USERNAME }}"
            TF_VAR_VSP_UAT_PASSWORD:                          !unsafe "{{TF_VAR_VSP_UAT_PASSWORD }}"
            TF_VAR_VSP_PRD_USERNAME:                          !unsafe "{{TF_VAR_VSP_PRD_USERNAME }}"
            TF_VAR_VSP_PRD_PASSWORD:                          !unsafe "{{TF_VAR_VSP_PRD_PASSWORD }}"
            TF_VAR_AD_DEV_PROXY_VM_USERNAME:                  !unsafe "{{TF_VAR_AD_DEV_PROXY_VM_USERNAME }}"
            TF_VAR_AD_DEV_PROXY_VM_PASSWORD:                  !unsafe "{{TF_VAR_AD_DEV_PROXY_VM_PASSWORD }}"
            TF_VAR_AD_PRD_PROXY_VM_USERNAME:                  !unsafe "{{TF_VAR_AD_PRD_PROXY_VM_USERNAME }}"
            TF_VAR_AD_PRD_PROXY_VM_PASSWORD:                  !unsafe "{{TF_VAR_AD_PRD_PROXY_VM_PASSWORD }}"
            TF_VAR_VSP_GBL_VM_WINDOWS_DEFAULT_ADMIN_PASSWORD: !unsafe "{{TF_VAR_VSP_GBL_VM_WINDOWS_DEFAULT_ADMIN_PASSWORD }}"
            TF_VAR_VSP_VM_DOMAIN_JOIN_USERNAME:               !unsafe "{{TF_VAR_VSP_VM_DOMAIN_JOIN_USERNAME }}"
            TF_VAR_VSP_VM_DOMAIN_JOIN_PASSWORD:               !unsafe "{{TF_VAR_VSP_VM_DOMAIN_JOIN_PASSWORD }}"
    credentials: &default_credentials
      Demo Credential:
        credential_type: Machine
        state: absent
      GIT_z_unixadm_prd:
        credential_type: Source Control
        organization: SCHRODERS
        inputs:
          username: z_unixadm_prd
          ssh_key_data: '{{ z_unixadm_prd_key }}'
      VAULT_STORAGE_pure:
        credential_type: Vault
        organization: STORAGE
        inputs:
          vault_password: '{{ VAULT_STORAGE_pure_password }}'
      GIT_pure_storage:
        credential_type: Source Control
        organization: STORAGE
        inputs:
          username: tower
          ssh_key_data: '{{ git_private_keys["GIT_pure_storage"]}}'
      MACHINE_z_unixadm_prd:
        credential_type: Machine
        organization: UNIX
        inputs:
          username: z_unixadm_prd
          ssh_key_data: '{{ z_unixadm_prd_key }}'
      SNOW_z_unixadm_prd:
        description: Credentials to log into ServiceNow
        credential_type: servicenow
        organization: SCHRODERS_INTERNAL
        inputs:
          SNOW_LOGIN: z_unixadm_prd
          SNOW_PASSWORD: '{{ snow_unixadm_pass }}'
          PROXY_LOGIN: "{{ prox_user }}"
          PROXY_PASSWORD: "{{ prox_pass }}"
  prd:
    custom_credential_types:
      <<: *custom_credential_types
    credentials:
      <<: *default_credentials
  dev:
    custom_credential_types:
      <<: *custom_credential_types
    credentials:
      <<: *default_credentials
  c_b:
    custom_credential_types:
      <<: *custom_credential_types    
    credentials:
      <<: *default_credentials
